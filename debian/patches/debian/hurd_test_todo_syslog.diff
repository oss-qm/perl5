From 99e0462f3a5f316a8b308d62a3e595f9cf81df5c Mon Sep 17 00:00:00 2001
From: Dominic Hargreaves <dom@earth.li>
Date: Sun, 27 Nov 2011 15:11:53 +0000
Subject: Disable failing GNU/Hurd tests in cpan/Sys-Syslog/t/syslog.t

Bug-Debian: http://bugs.debian.org/650093

Patch-Name: debian/hurd_test_todo_syslog.diff
---
 cpan/Sys-Syslog/t/syslog.t |   15 ++++++++++++---
 t/porting/customized.dat   |    1 +
 2 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/cpan/Sys-Syslog/t/syslog.t b/cpan/Sys-Syslog/t/syslog.t
index 8774677..00743cd 100644
--- a/cpan/Sys-Syslog/t/syslog.t
+++ b/cpan/Sys-Syslog/t/syslog.t
@@ -177,14 +177,20 @@ for my $sock_type (qw(native eventlog unix pipe stream inet tcp udp)) {
         # syslog() with level "info" (as a string), should pass
         $r = eval { syslog('info', "$test_string by connecting to a $sock_type socket") } || 0;
         is( $@, '', "[$sock_type] syslog() called with level 'info' (string)" );
-        ok( $r, "[$sock_type] syslog() should return true: '$r'" );
+        TODO: {
+            local $TODO = 'fails on GNU/Hurd (Debian #650093)' if $^O eq 'gnu';
+            ok( $r, "[$sock_type] syslog() should return true: '$r'" );
+        }
 
         # syslog() with level "info" (as a macro), should pass
         { local $! = 1;
           $r = eval { syslog(LOG_INFO(), "$test_string by connecting to a $sock_type socket, setting a fake errno: %m") } || 0;
         }
         is( $@, '', "[$sock_type] syslog() called with level 'info' (macro)" );
-        ok( $r, "[$sock_type] syslog() should return true: '$r'" );
+        TODO: {
+            local $TODO = 'fails on GNU/Hurd (Debian #650093)' if $^O eq 'gnu';
+            ok( $r, "[$sock_type] syslog() should return true: '$r'" );
+        }
 
         push @passed, $sock_type;
 
@@ -193,7 +199,10 @@ for my $sock_type (qw(native eventlog unix pipe stream inet tcp udp)) {
             # closelog()
             $r = eval { closelog() } || 0;
             is( $@, '', "[$sock_type] closelog()" );
-            ok( $r, "[$sock_type] closelog() should return true: '$r'" );
+            TODO: {
+                local $TODO = 'fails on GNU/Hurd (Debian #650093)' if $^O eq 'gnu';
+                ok( $r, "[$sock_type] closelog() should return true: '$r'" );
+            }
         }
     }
 }
diff --git a/t/porting/customized.dat b/t/porting/customized.dat
index bdb8eb2..edaac53 100644
--- a/t/porting/customized.dat
+++ b/t/porting/customized.dat
@@ -14,3 +14,4 @@ libnet cpan/libnet/Makefile.PL 5554b71464b45f5cc002e55f2464f7ff4abd05b6
 podlators cpan/podlators/scripts/pod2man.PL f81acf53f3ff46cdcc5ebdd661c5d13eb35d20d6
 podlators cpan/podlators/scripts/pod2text.PL b4693fcfe4a0a1b38a215cfb8985a65d5d025d69
 Module::Pluggable cpan/Module-Pluggable/Makefile.PL 72062c1a01ed7c62d16c55122c163b2d89f0d739
+Sys::Syslog cpan/Sys-Syslog/t/syslog.t c19ed717821be049fb77a916e3049c1b07f99179

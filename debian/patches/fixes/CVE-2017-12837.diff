From 3255989a4d3b82219377089315063840520ace38 Mon Sep 17 00:00:00 2001
From: Karl Williamson <khw@cpan.org>
Date: Wed, 21 Jun 2017 11:33:37 -0600
Subject: regcomp [perl #131582]

(cherry picked from commit 96c83ed78aeea1a0496dd2b2d935869a822dc8a5)

Origin: upstream, https://perl5.git.perl.org/perl.git/commit/66288bb3f44c8aa5122e5f40d8cfc0eada8b1695
Bug: https://rt.perl.org/Public/Bug/Display.html?id=131582
Bug-Debian: https://bugs.debian.org/875596
Patch-Name: fixes/CVE-2017-12837.diff
---
 regcomp.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/regcomp.c b/regcomp.c
index 54d641d82..1d2bced18 100644
--- a/regcomp.c
+++ b/regcomp.c
@@ -13229,6 +13229,7 @@ S_regatom(pTHX_ RExC_state_t *pRExC_state, I32 *flagp, U32 depth)
                             goto loopdone;
                         }
                         p = RExC_parse;
+                        RExC_parse = parse_start;
                         if (ender > 0xff) {
                             REQUIRE_UTF8(flagp);
                         }
